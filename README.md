# MangoShop — Мини-интернет-магазин

> **Внимание**: Это учебный проект. На данный момент реализованы только:
> - Система регистрации и авторизации пользователей  
> - Админ-панель для управления учётными записями (просмотр, создание, редактирование, удаление)  
> - Ролевая модель (администратор, редактор, обычный пользователь)  
> - Защита от CSRF и валидация данных

Полноценный магазин (товары, корзина, заказы) в текущей версии **не реализован**.

---

## Описание

**MangoShop** — учебный проект на чистом PHP без использования фреймворков.  
Цель — демонстрация базовых принципов веб-разработки: MVC-архитектура, безопасность, работа с БД, сессиями и формами.

---

## Технологии

- **Язык**: PHP 8.0+
- **База данных**: MySQL
- **Архитектура**: Минималистичная реализация MVC
- **Безопасность**:
  - CSRF-защита через токены
  - Хеширование паролей (`password_hash`)
  - Подготовленные SQL-запросы (PDO)
  - Проверка прав доступа (только админы могут заходить в админку)

---

## Установка

1. **Клонируйте репозиторий**
   ```bash
   git clone https://github.com/Araelka/MangoShop.git
   cd MangoShop```

2. **Настройте подключение к БД**
    Отредактируйте файл app/Config/DBConfig.php:

    - const DB_HOST = '127.0.0.1';
    - const DB_PORT = '3306';
    - const DB_NAME = 'mShop';
    - const DB_USER = 'root';
    - const DB_PASSWORD = '123456';

3. **Выполните миграции и заполните БД начальными данными**
    - php database/migrations/migrate.php
    - php database/seeds/seed.php

    После этого в базе данных будет создан:
    - Пользователь-админ: логин admin, пароль admin
    - Три роли: admin, editor, user

4. **Запустите встроенный сервер PHP**
    php -S localhost:8000 -t public/

5. **Откройте в браузере**
    - Главная страница: http://localhost:8000
    - Форма входа: http://localhost:8000/login
    - Регистрация: http://localhost:8000/register
    - Админ-панель: http://localhost:8000/admin (только для админов)

## Безопасность

- Все формы защищены уникальным CSRF-токеном.
- Пароли никогда не хранятся в открытом виде.
- Удаление или редактирование суперпользователя (ID = 1) запрещено даже админам.
- Невозможно изменить роль на несуществующую.
- Валидация форм: длина, формат, уникальность логина/email.

## Структура проекта

MangoShop/
├── app/
│   ├── Controllers/    # AuthController, AdminController, UserController
│   ├── Models/         # User, Auth, CsrfToken
│   ├── Validators/     # UserValidator
│   └── Views/          # Шаблоны: auth/ (login, register), admin/ (index, user), layout (header, footer), index
├── database/
│   ├── migrations/     # Создание таблиц roles и users
│   └── seeds/          # Наполнение ролями и админом
├── public/             # Точка входа (index.php)
└── vendor/             # Composer-зависимости (если используются)